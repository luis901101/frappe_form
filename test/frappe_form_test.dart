import 'dart:convert';

import 'package:frappe_form/src/entity/doc_field.dart';
import 'package:frappe_form/src/entity/doc_form.dart';
import 'package:frappe_form/src/logic/doc_field_group_controller.dart';
import 'package:flutter/foundation.dart';

String form1 = '''
{"name":"TestStructure","creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com","owner":"user@gmail.com","docstatus":0,"idx":0,"issingle":0,"is_virtual":0,"is_tree":0,"istable":0,"editable_grid":0,"track_changes":0,"module":"Culinary Forms","naming_rule":"","sort_field":"modified","sort_order":"DESC","read_only":0,"in_create":0,"allow_copy":0,"allow_rename":1,"allow_import":0,"hide_toolbar":0,"track_seen":0,"max_attachments":0,"document_type":"","engine":"InnoDB","is_submittable":0,"show_name_in_global_search":0,"custom":1,"beta":0,"has_web_view":0,"allow_guest_to_view":0,"email_append_to":0,"show_title_field_in_link":0,"translated_doctype":0,"is_calendar_and_gantt":0,"quick_entry":0,"track_views":0,"queue_in_background":0,"allow_events_in_timeline":0,"allow_auto_repeat":0,"make_attachments_public":0,"force_re_route_to_default_view":0,"show_preview_popup":0,"index_web_pages_for_search":1,"doctype":"DocType","permissions":[{"name":"g6fo8pe2m4","creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com","owner":"user@gmail.com","docstatus":0,"parent":"TestStructure","parentfield":"permissions","parenttype":"DocType","idx":1,"permlevel":0,"role":"System Manager","read":1,"write":1,"create":1,"submit":0,"cancel":0,"delete":1,"amend":0,"report":1,"export":1,"import":0,"share":1,"print":1,"email":1,"if_owner":0,"select":0,"doctype":"DocPerm"}],"fields":[{"docstatus":0,"doctype":"DocField","name":"m7pj74jl04","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Tab Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":1,"__run_link_triggers":1,"fieldname":"tab_1","label":"Tab 1","columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pjrpdae3","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Section Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":2,"__run_link_triggers":1,"fieldname":"tab_1_section_1","label":"Tab 1 Section 1","columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pjlqbesk","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Check","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":1,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":3,"fieldname":"check_1","label":"Check 1","show_preview_popup":0,"columns":0,"default":"0","length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pjmnah2f","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Check","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":1,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":1,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":4,"fieldname":"check_2","label":"Check 2","show_preview_popup":0,"columns":0,"default":"0","length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pj5pjbbs","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Column Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":5,"__run_link_triggers":1,"fieldname":"column_break_xknh","label":"Tab 1 Column Section","columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pjgotmmj","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Datetime","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":6,"__run_link_triggers":1,"fieldname":"date_time","label":"Fecha","columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pj9i8s9i","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Section Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":7,"fieldname":"tab_1_section_2","label":"Tab 1 Section 2","show_preview_popup":0,"columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pkccuu8o","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Small Text","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":8,"fieldname":"small_text_1","label":"Some text","show_preview_popup":0,"columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pkh91u65","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Tab Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":9,"fieldname":"tab_2","label":"Tab 2","show_preview_popup":0,"columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pkj6u7e8","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Section Break","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":10,"__run_link_triggers":1,"fieldname":"tab_2_section_1","label":"Tab 2 Section 1","columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"},{"docstatus":0,"doctype":"DocField","name":"m7pk200k6m","__unsaved":1,"owner":"user@gmail.com","fieldtype":"Data","precision":"","non_negative":0,"hide_days":0,"hide_seconds":0,"reqd":0,"is_virtual":0,"search_index":0,"sort_options":0,"show_dashboard":0,"fetch_if_empty":0,"hidden":0,"bold":0,"allow_in_quick_entry":0,"translatable":0,"print_hide":0,"print_hide_if_no_value":0,"report_hide":0,"collapsible":0,"hide_border":0,"in_list_view":0,"in_standard_filter":0,"in_preview":0,"in_filter":0,"in_global_search":0,"read_only":0,"allow_on_submit":0,"ignore_user_permissions":0,"allow_bulk_edit":0,"permlevel":0,"ignore_xss_filter":0,"unique":0,"no_copy":0,"set_only_once":0,"remember_last_selected_value":0,"parent":"TestStructure","parentfield":"fields","parenttype":"DocType","idx":11,"fieldname":"data_1","label":"Data","show_preview_popup":0,"columns":0,"length":0,"creation":"2025-04-23 04:30:45.596604","modified":"2025-04-23 10:00:40.382525","modified_by":"user@gmail.com"}],"states":[],"links":[],"actions":[],"__unsaved":0}
''';

void main() {
  try {
    final groupController = DocFieldGroupController();
    final form = DocForm.fromJson(jsonDecode(form1));
    final groups = groupController.generateGroups(form.fields);
    printGroups(groups);
  } catch (e) {
    if (kDebugMode) {
      print(e);
    }
  }
}

void printGroups(List<DocField> groups) {
  for (final group in groups) {
    printGroup(group);
  }
}

void printGroup(DocField group, {String level = ''}) {
  if (kDebugMode) {
    print('$level> Type: ${group.type?.name}, title: ${group.title}');
  }
  for (final field in group.children) {
    printGroup(field, level: '$level - ');
  }
}
